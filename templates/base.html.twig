{% set current_route = app.request.attributes.get('_route') %}
{% set current_route_params = app.request.attributes.get('_route_params') %}
{% set instance_configuration = get_instance_configuration() %}

<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
        <meta name="referrer" content="origin" />

        <title>{% block title %}{% block page_title '' %} | {{ instance_configuration.partyName }}{% endblock %}</title>

        <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500|Roboto+Slab:400,700&amp;subset=cyrillic,cyrillic-ext,greek,greek-ext" rel="stylesheet">
        {{ encore_entry_link_tags('lib') }}
        {{ encore_entry_link_tags('app') }}
        {% block stylesheets %}{% endblock %}
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

        <link rel="canonical" href="{% block meta_canonical current_route ? url(current_route, current_route_params) : '' %}" />
        <meta name="description" content="{{ instance_configuration.metaDescription }}" />

        <meta property="og:type" content="website" />
        <meta property="og:site_name" content="{{ instance_configuration.partyName }}" />
        <meta property="og:url" content="{{ url('app_homepage') }}" />
        <meta property="og:title" content="{{ block('page_title') }}" />
        <meta property="og:description" content="{{ instance_configuration.metaDescription }}" />
        <meta property="og:image" content="{{ image_asset(instance_configuration.metaImage, {'w': 1280, 'h': 560}, 0) }}" />
        <meta property="og:image:width" content="1280" />
        <meta property="og:image:height" content="560" />

        <link rel="apple-touch-icon" sizes="180x180" href="{{ image_asset(instance_configuration.favicon, {'w': 180, 'h': 180, 'fm': 'png'}) }}">
        <link rel="icon" type="image/png" sizes="32x32" href="{{ image_asset(instance_configuration.favicon, {'w': 32, 'h': 32, 'fm': 'png'}) }}">
        <link rel="icon" type="image/png" sizes="16x16" href="{{ image_asset(instance_configuration.favicon, {'w': 16, 'h': 16, 'fm': 'png'}) }}">

        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="{{ instance_configuration.partyName }}" />
        <meta name="twitter:description" content="{{ instance_configuration.metaDescription }}" />
        <meta name="twitter:image" content="{{ image_asset(instance_configuration.metaImage, {'w': 1280, 'h': 560}, 0) }}" />

        <script type="application/ld+json">
            {
                "@context": "http://schema.org",
                "@type": "Organization",
                "url": "{{ url('app_homepage') }}",
                "name": "{{ instance_configuration.partyName }}",
                "description": "{{ instance_configuration.metaDescription }}"
            }
        </script>
    </head>
    <body>
        <header class="header">
            <div class="container">
                <div class="header__row">
                    <div class="header__logo">
                        <a href="{{ path('app_homepage') }}">
                            <img src="{{ image_asset(instance_configuration.partyLogo, {'h': 100, 'c': instance_configuration.updatedAt.format('U')}) }}" />
                        </a>
                    </div>
                    <nav class="header__search">
                        <a href="{{ path('app_event_search') }}">
                            {{ 'layout.header.find_event'|trans }}
                        </a>
                        <a href="{{ path('app_group_search') }}">
                            {{ 'layout.header.find_group'|trans }}
                        </a>
                        {% if is_granted('GROUP_CREATE') %}
                            <a href="{{ path('app_group_creation_create') }}" class="text-primary">
                                {{ 'layout.header.create_group'|trans }}
                            </a>
                        {% endif %}
                    </nav>
                    <nav class="header__user">
                        {% if app.user %}
                            {% if is_granted('ROLE_ACTOR') %}
                                <a href="{{ path('app_actor_profile_edit') }}">
                                    {{ app.user.fullName }}
                                </a>
                            {% endif %}

                            {% if is_granted('ROLE_ADMIN') %}
                                <a href="{{ path('sonata_admin_dashboard') }}">
                                    {{ 'layout.header.admin.dashboard'|trans }}
                                </a>
                            {% elseif is_granted('ROLE_PREVIOUS_ADMIN') %}
                                <a href="{{ path('app_admin_impersonation_exit') }}">
                                    {{ 'layout.header.admin.quit_impersonation'|trans }}
                                </a>
                            {% else %}
                                <a href="{{ path('app_logout') }}">
                                    {{ 'layout.header.user.logout'|trans }}
                                </a>
                            {% endif %}
                        {% else %}
                            <a href="{{ path('app_login') }}">
                                {{ 'layout.header.user.login'|trans }}
                            </a>
                            <a href="{{ path('app_actor_registration_register') }}">
                                {{ 'layout.header.user.register'|trans }}
                            </a>
                        {% endif %}
                    </nav>
                </div>
            </div>
        </header>

        {% block intro '' %}

        <div class="container">
            {% block flash_message %}
                {% for message in app.flashes('info') %}
                    <div class="alert alert-primary">
                        {{ message|trans }}
                    </div>
                {% endfor %}

                {% block extra_flash_messages '' %}
            {% endblock %}

            {% block body '' %}
        </div>

        <footer class="footer">
            <div class="container">
                <div class="footer__row">
                    <div class="footer__copyright">
                        Â© {{ instance_configuration.partyName }}
                    </div>
                    <div class="footer__links">
                        <a href="">
                            {{ 'layout.footer.legalities'|trans }}
                        </a>
                        <a href="">
                            {{ 'layout.footer.terms'|trans }}
                        </a>
                        <a href="">
                            {{ 'layout.footer.privacy'|trans }}
                        </a>
                        <a href="">
                            {{ 'layout.footer.contact'|trans }}
                        </a>
                    </div>
                </div>
            </div>
        </footer>

        <script type="application/json" id="exposed_data">{% block exposed_data data_exposer_json() %}</script>
        {% block javascripts %}{% endblock %}
    </body>
</html>
